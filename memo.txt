ActiveXコントロール
	・CCX::Managerを保持する
	・外部からのプロパティやメソッドをCCX::Managerに伝える
	・OnLButtonDownなどのマウス操作を対応する（デザインモード時は抑制）
		ON_WM_CREATE()
		ON_WM_SIZE()
		ON_WM_DESTROY()
		ON_WM_LBUTTONDOWN()
		ON_WM_LBUTTONUP()
		ON_WM_MOUSEMOVE()
		ON_WM_MOUSEWHEEL()
		ON_WM_SETCURSOR()

	GetIsMouseDragPan, SetIsMouseDragPan / GetIsMouseWheelZoom, SetIsMouseWheelZoom
		・マウス操作の許可状態を取得/設定
			DISP_PROPERTY_EX(CCadCanvasCtrl, "IsMouseDragPan", GetIsMouseDragPan, SetIsMouseDragPan, VT_BOOL)
			DISP_PROPERTY_EX(CCadCanvasCtrl, "IsMouseWheelZoom", GetIsMouseWheelZoom, SetIsMouseWheelZoom, VT_BOOL)


CCX::Manager
	・制御レイヤー、レイヤーコレクションを持つ
		→CCX::Layer
	・描画用のDCを受け取りドロワーオブジェクトとして保持する
		→CCX::Drawer

	・コントロールの参照も保持する
	・外部から設定する描画プロパティ関連もここで持つ
	・初期化時、制御レイヤーとレイヤーコレクション内を１枚生成する
	　制御レイヤ－には、軸やグリッド等をプロパティに従って登録する。

	・描画に関するプロパティ情報を保持する
		DISP_PROPERTY_EX(CCadCanvasCtrl, "BaseColor", GetBaseColor, SetBaseColor, VT_COLOR)
		DISP_PROPERTY_EX(CCadCanvasCtrl, "GridColor", GetGridColor, SetGridColor, VT_COLOR)
		DISP_PROPERTY_EX(CCadCanvasCtrl, "GridSize", GetGridSize, SetGridSize, VT_R8)
		DISP_PROPERTY_EX(CCadCanvasCtrl, "OriginColor", GetOriginColor, SetOriginColor, VT_COLOR)
		DISP_PROPERTY_EX(CCadCanvasCtrl, "OriginSize", GetOriginSize, SetOriginSize, VT_I4)
		DISP_PROPERTY_EX(CCadCanvasCtrl, "AxisColor", GetAxisColor, SetAxisColor, VT_COLOR)
		DISP_PROPERTY_EX(CCadCanvasCtrl, "AxisScale", GetAxisScale, SetAxisScale, VT_R8)
		DISP_PROPERTY_EX(CCadCanvasCtrl, "IsDrawGrid", GetIsDrawGrid, SetIsDrawGrid, VT_BOOL)
		DISP_PROPERTY_EX(CCadCanvasCtrl, "IsDrawOrigin", GetIsDrawOrigin, SetIsDrawOrigin, VT_BOOL)
		DISP_PROPERTY_EX(CCadCanvasCtrl, "IsDrawAxis", GetIsDrawAxis, SetIsDrawAxis, VT_BOOL)
		DISP_PROPERTY_EX(CCadCanvasCtrl, "IsDrawArrow", GetIsDrawArrow, SetIsDrawArrow, VT_BOOL)
		DISP_PROPERTY_EX(CCadCanvasCtrl, "IsDrawCenter", GetIsDrawCenter, SetIsDrawCenter, VT_BOOL)

	AddXXX
		・カレントレイヤーに、外部から登録指示された種類のノードを追加する。
			DISP_FUNCTION(CCadCanvasCtrl, "Line", Line, VT_EMPTY, VTS_R8 VTS_R8 VTS_R8 VTS_R8)
			DISP_FUNCTION(CCadCanvasCtrl, "InfLine2P", InfLine2P, VT_EMPTY, VTS_R8 VTS_R8 VTS_R8 VTS_R8)
			DISP_FUNCTION(CCadCanvasCtrl, "InfLine1PAngle", InfLine1PAngle, VT_EMPTY, VTS_R8 VTS_R8 VTS_R8)
			DISP_FUNCTION(CCadCanvasCtrl, "Point", Point, VT_EMPTY, VTS_R8 VTS_R8 VTS_I2)
			DISP_FUNCTION(CCadCanvasCtrl, "Arc", Arc, VT_EMPTY, VTS_R8 VTS_R8 VTS_R8 VTS_R8 VTS_R8 VTS_R8 VTS_I2)
			DISP_FUNCTION(CCadCanvasCtrl, "Circle", Circle, VT_EMPTY, VTS_R8 VTS_R8 VTS_R8)
			DISP_FUNCTION(CCadCanvasCtrl, "FillPolygon", FillPolygon, VT_EMPTY, VTS_PR8 VTS_I2)
			DISP_FUNCTION(CCadCanvasCtrl, "FillCircle", FillCircle, VT_EMPTY, VTS_R8 VTS_R8 VTS_R8)
			DISP_FUNCTION(CCadCanvasCtrl, "FillArcRect", FillArcRect, VT_EMPTY, VTS_R8 VTS_R8 VTS_R8 VTS_R8 VTS_R8 VTS_R8 VTS_R8 VTS_I2)
			DISP_FUNCTION(CCadCanvasCtrl, "Grid", Grid, VT_EMPTY, VTS_NONE)
			DISP_FUNCTION(CCadCanvasCtrl, "Origin", Origin, VT_EMPTY, VTS_NONE)
			DISP_FUNCTION(CCadCanvasCtrl, "SetPen", SetPen, VT_EMPTY, VTS_COLOR VTS_I4 VTS_I4 VTS_I2)
			DISP_FUNCTION(CCadCanvasCtrl, "SetBrush", SetBrush, VT_EMPTY, VTS_COLOR VTS_I4)
			DISP_FUNCTION(CCadCanvasCtrl, "InsertLayer", InsertLayer, VT_BOOL, VTS_I2)
			DISP_FUNCTION(CCadCanvasCtrl, "ClearCurrentLayer", ClearCurrentLayer, VT_EMPTY, VTS_NONE)
			DISP_FUNCTION(CCadCanvasCtrl, "DeleteCurrentLayer", DeleteCurrentLayer, VT_I2, VTS_NONE)
			DISP_FUNCTION(CCadCanvasCtrl, "SetCurrentLayerDrawing", SetCurrentLayerDrawing, VT_EMPTY, VTS_BOOL)
			*DISP_FUNCTION(CCadCanvasCtrl, "SetPolygonElement", SetPolygonElement, VT_BOOL, VTS_R8 VTS_R8)
			*DISP_FUNCTION(CCadCanvasCtrl, "DelPolygonElement", DelPolygonElement, VT_EMPTY, VTS_NONE)
			*DISP_FUNCTION(CCadCanvasCtrl, "FillPolygonElement", FillPolygonElement, VT_EMPTY, VTS_NONE)
			*DISP_FUNCTION(CCadCanvasCtrl, "ClipLayerPolygon", ClipLayerPolygon, VT_EMPTY, VTS_PR8 VTS_I2)
			*DISP_FUNCTION(CCadCanvasCtrl, "ClipLayerPolygonElement", ClipLayerPolygonElement, VT_EMPTY, VTS_NONE)

	GetBoundingBox
		・全レイヤーの最小矩形箱を再帰的に算出
	Draw
		・最初に背景色で塗り潰し
		・制御レイヤー、レイヤーコレクションのDrawを順番に呼び出す
		・呼び出す際はコントロールの矩形を渡していく
		・ダイアログのOnDraw()から呼び出されることを想定
		・デザインモードの場合は専用処理（専用レイヤーに描画内容を積んでDraw？）

		DISP_FUNCTION(CCadCanvasCtrl, "Redraw", Redraw, VT_EMPTY, VTS_NONE)

	ClearAll
		・レイヤーコレクションを削除
		DISP_FUNCTION(CCadCanvasCtrl, "Clear", Clear, VT_EMPTY, VTS_NONE)


	GetCurrentLayer / SetCurrentLayer
		・カレントレイヤー番号を取得/設定
			DISP_PROPERTY_EX(CCadCanvasCtrl, "CurrentLayer", GetCurrentLayer, SetCurrentLayer, VT_I2)

	GetLayerCount
		・レイヤー枚数を取得
			DISP_PROPERTY_EX(CCadCanvasCtrl, "LayerCount", GetLayerCount, SetNotSupported, VT_I2)

	・マウス操作による拡大縮小率を設定できてもよいか
		DISP_FUNCTION(CCadCanvasCtrl, "Zoom", Zoom, VT_BOOL, VTS_R8 VTS_PI4)
		DISP_FUNCTION(CCadCanvasCtrl, "Pan", Pan, VT_BOOL, VTS_I4 VTS_I4)
		DISP_FUNCTION(CCadCanvasCtrl, "Fit", Fit, VT_EMPTY, VTS_R8)


CCX::Canvas

	CadToCanvas / CanvasToCad
		・オフセットや拡大率をここで持つ
		・座標系変換
			DISP_FUNCTION(CCadCanvasCtrl, "CadToCanvas", CadToCanvas, VT_EMPTY, VTS_PI4 VTS_PI4 VTS_R8 VTS_R8)
			DISP_FUNCTION(CCadCanvasCtrl, "CanvasToCad", CanvasToCad, VT_EMPTY, VTS_PR8 VTS_PR8 VTS_I4 VTS_I4)

	FillBackground
		・背景色で塗り潰し
	DrawGrid / DrawAxis / DrawOrigin
	DrawTriPoint / DrawCirclePoint / DrawArrow / DrawBezierArc
		・描画ヘルパー処理

	SaveBitmap / CopyBitmap
		・ビットマップ操作
			DISP_FUNCTION(CCadCanvasCtrl, "SaveBitmap", SaveBitmap, VT_BOOL, VTS_BSTR VTS_BOOL)
			DISP_FUNCTION(CCadCanvasCtrl, "CopyBitmap", CopyBitmap, VT_BOOL, VTS_NONE)


CCX::Layer
	・ノードコレクションを持つ
		→CCX::Node
	・生成時に管理オブジェクトの参照を受け取る
		→CCX::Manager

	GetBoundingBox
		・全ノードの最小矩形箱を再帰的に算出
	Draw
		・ノードコレクションのDrawを順番に呼び出す
		・呼び出す際はコントロールの矩形を渡していく


CCX::Node
	・生成時に管理オブジェクトの参照を受け取る
		→CCX::Manager

	GetBoundingBox
		・最小矩形箱を算出
	IsElemInDrawArea
		・コントロール矩形に形状が含まれるか
	Draw
		・コントロール矩形に形状が含まれる場合は描画を行う


CCX::NodeXXX
	・Nodeから派生する。形状種類分用意。
		E_ID_PEN,			// ペン変更
		E_ID_BRUSH,			// ブラシ変更
		E_ID_POINT,			// 点
		E_ID_TRIPOINT,		// 三角点
		E_ID_FCIRCLEPOINT,	// 黒丸点
		E_ID_LINE,			// 線分
		E_ID_INFLINE,		// 無限直線
		E_ID_CWARC,			// CW円弧
		E_ID_CCWARC,		// CCW円弧
		E_ID_CIRCLE,		// 円
		E_ID_FILLPOLYGON,	// 多角形(塗りつぶし)
		E_ID_FILLCIRCLE,	// 円(塗りつぶし)
		E_ID_FILLCWRECT,	// CW円弧矩形(塗りつぶし)
		E_ID_FILLCCWRECT,	// CCW円弧矩形(塗りつぶし)
		E_ID_GRID,			// グリッド
		E_ID_ORIGIN,		// 原点

	GetBoundingBox
	IsElemInDrawArea
	Draw
		形状種類に合わせてオーバーライド

